CREATE TABLE Postac(ID INT PRIMARY KEY NOT NULL, Imie VARCHAR(40), Rodzaj ENUM('wiking','ptak','kobieta'), DataUr DATE, Wiek INT);
INSERT INTO Postac(ID,Imie,Rodzaj,DataUr,Wiek) VALUES(1,'Bjorn','wiking','2003-10-20',19);
INSERT INTO Postac(ID,Imie,Rodzaj,DataUr,Wiek) VALUES(2,'Drozd','ptak','1990-10-20',31);
INSERT INTO Postac(ID,Imie,Rodzaj,DataUr,Wiek) VALUES(3,'Tesciowa','kobieta','1890-10-20',131);
UPDATE Postac SET Wiek = 88 WHERE Imie = 'Tesciowa';
CREATE TABLE Walizka(ID INT PRIMARY KEY AUTO_INCREMENT, Pojemnosc INT, Kolor ENUM('rozowy','czerwony','teczowy','zolty'), ID_Wlasciciela INT, FOREIGN KEY (ID_Wlasciciela) REFERENCES Postac(ID));
ALTER TABLE Walizka ADD DEFAULT 'rozowy' FOR Kolor;
INSERT INTO Walizka(Pojemnosc,Kolor,ID_Wlasciciela) VALUES(20,'czerwony',1);
INSERT INTO Walizka(Pojemnosc,Kolor,ID_Wlasciciela) VALUES(35,'rozowy',3);
CREATE TABLE Izba(Adres VARCHAR(50), NAZWA VARCHAR (50), metraz INT, IdWlasciciela INT, FOREIGN KEY (IdWlasciciela) REFERENCES Postac(ID),PRIMARY KEY (Adres, Nazwa));
ALTER TABLE Izba ADD Kolor varchar(20) DEFAULT ('czarny');
INSERT INTO Izba(Nazwa,Adres,Metraz,Kolor,IdWlasciciela) Values ('Spizarnia','Kamien na gorce',150,'czerwony',5);
CREATE TABLE Przetwory(ID INT PRIMARY KEY, RokProdukcji YEAR DEFAULT '1954',IdWykonawcy INT, Zawartosc VARCHAR(100),Dodatek VARCHAR(100) DEFAULT 'papryczka chilli', IdKonsumenta INT, FOREIGN KEY (IdWykonawcy) REFERENCES Postac(ID), FOREIGN KEY (IdKonsumenta) REFERENCES Postac(ID));
INSERT INTO Przetwory(ID,IdWykonawcy,Zawartosc,IdKonsumenta) VALUES(1,1,'Bigos',1);
INSERT INTO Postac(ID,Imie,Rodzaj,DataUr,Wiek) VALUES (4,'Kuba', 'wiking','1990-01-01',31);
INSERT INTO Postac(ID,Imie,Rodzaj,DataUr,Wiek) VALUES (5,'Andrzej', 'wiking','1990-01-01',31);
INSERT INTO Postac(ID,Imie,Rodzaj,DataUr,Wiek) VALUES (6,'Lukasz', 'wiking','1990-01-01',31);
INSERT INTO Postac(ID,Imie,Rodzaj,DataUr,Wiek) VALUES (7,'Kamil', 'wiking','1990-01-01',31);
INSERT INTO Postac(ID,Imie,Rodzaj,DataUr,Wiek) VALUES (8,'Eivor', 'wiking','1990-01-01',31);
CREATE TABLE Statek(Nazwa VARCHAR(50) PRIMARY KEY, Rodzaj ENUM('plywajacy','zatopiony'),DataWodowania DATE,Ladownosc INT);
INSERT INTO Statek(Nazwa,Rodzaj,DataWodowania,Ladownosc) VALUES ('Maria','plywajacy','2021-11-02',10);
INSERT INTO Statek(Nazwa,Rodzaj,DataWodowania,Ladownosc) VALUES ('Syrena','zatopiony','2021-11-02',5);
ALTER TABLE Postac ADD Funkcja varchar(50);
UPDATE Postac SET Funkcja = 'kapitan' WHERE Imie = 'Bjorn';
ALTER TABLE Postac ADD Statek varchar(50);
ALTER TABLE Postac ADD FOREIGN KEY (Statek) REFERENCES Statek(Nazwa);
UPDATE Postac SET Statek = 'Maria' WHERE Rodzaj = 'wiking';
UPDATE Postac SET Statek = 'Maria' WHERE Imie = 'Drozd';
DELETE FROM Izba WHERE Nazwa = 'spizarnia';
DROP TABLE Izba;

DELETE FROM Postac WHERE ID = 6;
DELETE FROM Postac WHERE ID = 7;
ALTER TABLE Walizka DROP FOREIGN KEY Walizka_ibfk_1;
ALTER TABLE Przetwory DROP FOREIGN KEY Przetwory_ibfk_1;
ALTER TABLE Przetwory DROP FOREIGN KEY Przetwory_ibfk_2;
ALTER TABLE Postac DROP ID;
ALTER TABLE Postac ADD Pesel VARCHAR(11) NOT NULL;
UPDATE Postac SET Pesel = "1" where Imie = 'Bjorn';
UPDATE Postac SET Pesel = "2" where Imie = 'Drozd';
UPDATE Postac SET Pesel = "10" where Imie = 'Tescowa';
UPDATE Postac SET Pesel = "3" where Imie = 'Kuba';
UPDATE Postac SET Pesel = "4" where Imie = 'Andrzej';
UPDATE Postac SET Pesel = "5" where Imie = 'Eivor';
ALTER TABLE Postac ADD PRIMARY KEY(Pesel);
ALTER TABLE Postac MODIFY COLUMN Rodzaj ENUM('wiking','ptak','kobieta','syrena');
INSERT INTO Postac(Imie,Rodzaj,DataUr,Wiek,Pesel) VALUES ('Gertruda Nieszczera','syrena','2021-11-09',1,11);
UPDATE Postac SET Statek = 'Maria' WHERE Imie LIKE '%a%';
UPDATE Postac SET Statek = NULL WHERE Imie = 'Tesciowa';
UPDATE Postac SET Statek = NULL WHERE Imie = 'Gertruda Nieszczera';
UPDATE Statek SET Ladownosc = Ladownosc * 0.7 WHERE DataWodowania BETWEEN '1901-01-01' AND '1999-12-31';
SELECT * FROM Postac WHERE Wiek > 1000;
INSERT INTO Postac(Imie,DataUr,Wiek,Pesel) VALUES ('Loko','1921-11-09',100,12);
CREATE TABLE Marynarz LIKE Postac;
INSERT INTO Marynarz SELECT * FROM Postac WHERE Statek = 'Maria';
UPDATE Marynarz SET Statek = NULL;
DELETE FROM Marynarz WHERE Pesel = '4';
UPDATE Postac SET Statek = NULL;
DELETE FROM Statek;
ALTER TABLE Postac DROP FOREIGN KEY Postac_ibfk_1;
DROP TABLE Statek;
CREATE TABLE Zwierz(ID INT PRIMARY KEY AUTO_INCREMENT, Nazwa VARCHAR(30),Wiek INT);
INSERT INTO Zwierz(Nazwa,Wiek) VALUES('Drozd',31);
INSERT INTO Zwierz(Nazwa,Wiek) VALUES('Loko',100);

CREATE TABLE Kreatura LIKE wikingowie.kreatura;
INSERT INTO Kreatura SELECT * FROM wikingowie.kreatura;
CREATE TABLE Zasob LIKE wikingowie.zasob;
INSERT INTO Zasob SELECT * FROM wikingowie.zasob;
CREATE TABLE Ekwipunek LIKE wikingowie.ekwipunek;
INSERT INTO Ekwipunek SELECT * FROM wikingowie.ekwipunek;
SELECT * FROM Zasob;
SELECT * FROM Zasob WHERE rodzaj = 'jedzenie';
SELECT idZasobu,ilosc FROM Ekwipunek WHERE idKreatury = 1 or idKreatury = 3 or idKreatury = 5;
SELECT * FROM Kreatura WHERE NOT rodzaj = 'wiedzma' AND udzwig > 50;
SELECT * FROM Zasob WHERE waga BETWEEN 2 AND 5;
SELECT * FROM Kreatura WHERE nazwa like '%or%' AND udzwig BETWEEN 30 AND 70;
SELECT * FROM Zasob WHERE MONTH(dataPozyskania) BETWEEN 7 AND 8;
SELECT * FROM Zasob WHERE NOT rodzaj IS NULL ORDER BY waga;
SELECT * FROM Kreatura ORDER BY dataUr DESC LIMIT 5;
SELECT DISTINCT rodzaj FROM Zasob;
SELECT DISTINCT nazwa,rodzaj FROM Kreatura WHERE rodzaj LIKE 'wi%';
SELECT nazwa,waga*ilosc FROM Zasob WHERE YEAR(dataPozyskania) BETWEEN 2000 AND 2007;
SELECT nazwa,waga*ilosc*0.7 AS 'Netto', waga*ilosc*0.3 AS 'Odpady' FROM Zasob WHERE rodzaj = 'jedzenie';
SELECT * FROM Zasob WHERE rodzaj IS NULL;
SELECT DISTINCT nazwa FROM Zasob WHERE nazwa LIKE 'ba%' or nazwa LIKE '%os';

select Sum(waga)/Count(*) as 'srednia waga' from kreatura where rodzaj = 'wiking';
select rodzaj,Sum(waga)/Count(*) as 'srednia waga', Count(*) from kreatura group by rodzaj;
select rodzaj,Sum(2021-year(dataUr))/Count(*) as 'sredni wiek' from kreatura group by rodzaj;
select rodzaj,Sum(waga) as 'suma wagi' from zasob group by rodzaj;
select rodzaj,Sum(waga)/Count(*) as 'srednia wag' from zasob group by rodzaj having Sum(waga)>10 and Count(*)>4;
select rodzaj,Count(Distinct(nazwa)) as 'unikalne nazwy' from zasob group by rodzaj having Count(*)>1;
select kreatura.idKreatury, sum(ekwipunek.ilosc) from ekwipunek inner join kreatura on ekwipunek.idKreatury = kreatura.idKreatury group by kreatura.idKreatury;
select kreatura.idKreatury, zasob.nazwa from ekwipunek inner join kreatura on ekwipunek.idKreatury = kreatura.idKreatury left join zasob on ekwipunek.idZasobu = zasob.idZasobu;
select kreatura.idKreatury from kreatura left join ekwipunek on kreatura.idKreatury = ekwipunek.idKreatury where ekwipunek.idKreatury is null;
select kreatura.nazwa, zasob.nazwa from kreatura inner join ekwipunek on kreatura.idKreatury = ekwipunek.idKreatury inner join zasob on zasob.idZasobu = ekwipunek.idZasobu where kreatura.dataUr between '1600-01-01' and '1700-01-01' and kreatura.rodzaj = 'wiking';
select kreatura.nazwa from kreatura inner join ekwipunek on kreatura.idKreatury = ekwipunek.idKreatury inner join zasob on zasob.idZasobu = ekwipunek.idZasobu where zasob.rodzaj = 'jedzenie' order by kreatura.dataUr asc limit 5;
select t1.nazwa,t2.nazwa from kreatura t1, kreatura t2 where t1.idKreatury = t2.idKreatury+5;
